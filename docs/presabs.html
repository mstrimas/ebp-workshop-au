<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Lesson 6 Presence-absence Data | eBird Best Practices Workshop</title>
  <meta name="description" content="Best practices for using eBird data to estimate species distributions" />
  <meta name="generator" content="bookdown 0.13.2 and GitBook 2.6.7" />

  <meta property="og:title" content="Lesson 6 Presence-absence Data | eBird Best Practices Workshop" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Best practices for using eBird data to estimate species distributions" />
  <meta name="github-repo" content="mstrimas/ebp-workshop" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Lesson 6 Presence-absence Data | eBird Best Practices Workshop" />
  
  <meta name="twitter:description" content="Best practices for using eBird data to estimate species distributions" />
  

<meta name="author" content="Matthew Strimas-Mackey, Alison Johnston, Wesley M. Hochachka, Viviana Ruiz-Gutierrez, Orin J. Robinson, Eliot T. Miller, Tom Auer, Steve Kelling, Daniel Fink" />


<meta name="date" content="2019-11-13" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="import.html"/>
<link rel="next" href="subsampling.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="assets/css/style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">eBird Best Practices Workshop</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Welcome</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="intro.html"><a href="intro.html#intro-data"><i class="fa fa-check"></i><b>1.1</b> Data</a></li>
<li class="chapter" data-level="1.2" data-path="intro.html"><a href="intro.html#intro-format"><i class="fa fa-check"></i><b>1.2</b> Format</a></li>
<li class="chapter" data-level="1.3" data-path="intro.html"><a href="intro.html#intro-setup"><i class="fa fa-check"></i><b>1.3</b> Setup</a></li>
<li class="chapter" data-level="1.4" data-path="intro.html"><a href="intro.html#intro-tidyverse"><i class="fa fa-check"></i><b>1.4</b> Tidyverse</a></li>
</ul></li>
<li class="part"><span><b>I eBird Data</b></span></li>
<li class="chapter" data-level="2" data-path="ebird-intro.html"><a href="ebird-intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a><ul>
<li class="chapter" data-level="2.1" data-path="ebird-intro.html"><a href="ebird-intro.html#the-auk-workflow"><i class="fa fa-check"></i><b>2.1</b> The <code>auk</code> workflow</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="access.html"><a href="access.html"><i class="fa fa-check"></i><b>3</b> Data Access</a></li>
<li class="chapter" data-level="4" data-path="filter.html"><a href="filter.html"><i class="fa fa-check"></i><b>4</b> Filtering</a><ul>
<li class="chapter" data-level="4.1" data-path="filter.html"><a href="filter.html#filter-define"><i class="fa fa-check"></i><b>4.1</b> Defining filters</a><ul>
<li class="chapter" data-level="4.1.1" data-path="filter.html"><a href="filter.html#filter-define-complete"><i class="fa fa-check"></i><b>4.1.1</b> Complete checklists</a></li>
</ul></li>
<li class="chapter" data-level="4.2" data-path="filter.html"><a href="filter.html#filter-execute"><i class="fa fa-check"></i><b>4.2</b> Execute filters</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="import.html"><a href="import.html"><i class="fa fa-check"></i><b>5</b> Importing Data</a><ul>
<li class="chapter" data-level="5.1" data-path="import.html"><a href="import.html#import-group"><i class="fa fa-check"></i><b>5.1</b> Group checklists</a></li>
<li class="chapter" data-level="5.2" data-path="import.html"><a href="import.html#import-taxonomy"><i class="fa fa-check"></i><b>5.2</b> Taxonomy</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="presabs.html"><a href="presabs.html"><i class="fa fa-check"></i><b>6</b> Presence-absence Data</a><ul>
<li class="chapter" data-level="6.1" data-path="presabs.html"><a href="presabs.html#presabs-filter"><i class="fa fa-check"></i><b>6.1</b> Filtering</a></li>
<li class="chapter" data-level="6.2" data-path="presabs.html"><a href="presabs.html#presabs-zerofill"><i class="fa fa-check"></i><b>6.2</b> Zero-filling</a></li>
<li class="chapter" data-level="6.3" data-path="presabs.html"><a href="presabs.html#presabs-tidy"><i class="fa fa-check"></i><b>6.3</b> Tidying up</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="subsampling.html"><a href="subsampling.html"><i class="fa fa-check"></i><b>7</b> Spatiotemporal Subsampling</a><ul>
<li class="chapter" data-level="7.1" data-path="subsampling.html"><a href="subsampling.html#subsampling-toy"><i class="fa fa-check"></i><b>7.1</b> A toy example</a></li>
<li class="chapter" data-level="7.2" data-path="subsampling.html"><a href="subsampling.html#subsampling-ebird"><i class="fa fa-check"></i><b>7.2</b> Subsampling eBird data</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="applications.html"><a href="applications.html"><i class="fa fa-check"></i><b>8</b> Applications</a><ul>
<li class="chapter" data-level="8.1" data-path="applications.html"><a href="applications.html#applications-trajectory"><i class="fa fa-check"></i><b>8.1</b> Frequency trajectories</a></li>
<li class="chapter" data-level="8.2" data-path="applications.html"><a href="applications.html#applications-maps"><i class="fa fa-check"></i><b>8.2</b> Maps</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="advanced.html"><a href="advanced.html"><i class="fa fa-check"></i><b>9</b> Advanced Topics</a><ul>
<li class="chapter" data-level="9.1" data-path="advanced.html"><a href="advanced.html#advanced-unmarked"><i class="fa fa-check"></i><b>9.1</b> Preparing for occupancy modeling</a></li>
<li class="chapter" data-level="9.2" data-path="advanced.html"><a href="advanced.html#advanced-modis"><i class="fa fa-check"></i><b>9.2</b> Land cover covariates</a></li>
<li class="chapter" data-level="9.3" data-path="advanced.html"><a href="advanced.html#advanced-custom"><i class="fa fa-check"></i><b>9.3</b> Custom downloads</a></li>
<li class="chapter" data-level="9.4" data-path="advanced.html"><a href="advanced.html#advanced-size"><i class="fa fa-check"></i><b>9.4</b> Reducing file size</a><ul>
<li class="chapter" data-level="9.4.1" data-path="advanced.html"><a href="advanced.html#advanced-size-strict"><i class="fa fa-check"></i><b>9.4.1</b> Stricter filtering</a></li>
<li class="chapter" data-level="9.4.2" data-path="advanced.html"><a href="advanced.html#advanced-size-columns"><i class="fa fa-check"></i><b>9.4.2</b> Removing columns</a></li>
<li class="chapter" data-level="9.4.3" data-path="advanced.html"><a href="advanced.html#advanced-size-split"><i class="fa fa-check"></i><b>9.4.3</b> Splitting by species</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>II Distribution Modeling</b></span></li>
<li class="chapter" data-level="10" data-path="model-intro.html"><a href="model-intro.html"><i class="fa fa-check"></i><b>10</b> Introduction</a><ul>
<li class="chapter" data-level="10.1" data-path="model-intro.html"><a href="model-intro.html#model-intro-data"><i class="fa fa-check"></i><b>10.1</b> Example data</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="encounter.html"><a href="encounter.html"><i class="fa fa-check"></i><b>11</b> Encounter Rate</a><ul>
<li class="chapter" data-level="11.1" data-path="encounter.html"><a href="encounter.html#encounter-prep"><i class="fa fa-check"></i><b>11.1</b> Data preparation</a></li>
<li class="chapter" data-level="11.2" data-path="encounter.html"><a href="encounter.html#encounter-rf"><i class="fa fa-check"></i><b>11.2</b> Random forests</a><ul>
<li class="chapter" data-level="11.2.1" data-path="encounter.html"><a href="encounter.html#encounter-rf-cal"><i class="fa fa-check"></i><b>11.2.1</b> Calibration</a></li>
<li class="chapter" data-level="11.2.2" data-path="encounter.html"><a href="encounter.html#encounter-rf-assess"><i class="fa fa-check"></i><b>11.2.2</b> Model assessment</a></li>
</ul></li>
<li class="chapter" data-level="11.3" data-path="encounter.html"><a href="encounter.html#encounter-habitat"><i class="fa fa-check"></i><b>11.3</b> Habitat associations</a><ul>
<li class="chapter" data-level="11.3.1" data-path="encounter.html"><a href="encounter.html#encounter-habitat-pi"><i class="fa fa-check"></i><b>11.3.1</b> Predictor importance</a></li>
<li class="chapter" data-level="11.3.2" data-path="encounter.html"><a href="encounter.html#encounter-habitat-pd"><i class="fa fa-check"></i><b>11.3.2</b> Partial dependence</a></li>
</ul></li>
<li class="chapter" data-level="11.4" data-path="encounter.html"><a href="encounter.html#encounter-predict"><i class="fa fa-check"></i><b>11.4</b> Prediction</a></li>
<li class="chapter" data-level="11.5" data-path="encounter.html"><a href="encounter.html#encouter-exercises"><i class="fa fa-check"></i><b>11.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="12" data-path="occupancy.html"><a href="occupancy.html"><i class="fa fa-check"></i><b>12</b> Occupancy</a><ul>
<li class="chapter" data-level="12.1" data-path="occupancy.html"><a href="occupancy.html#occupancy-prep"><i class="fa fa-check"></i><b>12.1</b> Data preparation</a></li>
<li class="chapter" data-level="12.2" data-path="occupancy.html"><a href="occupancy.html#occupancy-model"><i class="fa fa-check"></i><b>12.2</b> Occupancy modeling</a><ul>
<li class="chapter" data-level="12.2.1" data-path="occupancy.html"><a href="occupancy.html#occupancy-model-assess"><i class="fa fa-check"></i><b>12.2.1</b> Assessment</a></li>
</ul></li>
<li class="chapter" data-level="12.3" data-path="occupancy.html"><a href="occupancy.html#occupancy-predict"><i class="fa fa-check"></i><b>12.3</b> Prediction</a></li>
<li class="chapter" data-level="12.4" data-path="occupancy.html"><a href="occupancy.html#occupancy-select"><i class="fa fa-check"></i><b>12.4</b> Model selection</a><ul>
<li class="chapter" data-level="12.4.1" data-path="occupancy.html"><a href="occupancy.html#occupancy-select-detection"><i class="fa fa-check"></i><b>12.4.1</b> Detection model</a></li>
</ul></li>
<li class="chapter" data-level="12.5" data-path="occupancy.html"><a href="occupancy.html#occupancy-exercises"><i class="fa fa-check"></i><b>12.5</b> Exercises</a></li>
</ul></li>
<li class="chapter" data-level="13" data-path="abundance.html"><a href="abundance.html"><i class="fa fa-check"></i><b>13</b> Abundance</a><ul>
<li class="chapter" data-level="13.1" data-path="abundance.html"><a href="abundance.html#abundance-prep"><i class="fa fa-check"></i><b>13.1</b> Data preparation</a></li>
<li class="chapter" data-level="13.2" data-path="abundance.html"><a href="abundance.html#abundance-explore"><i class="fa fa-check"></i><b>13.2</b> Exploratory data analysis</a></li>
<li class="chapter" data-level="13.3" data-path="abundance.html"><a href="abundance.html#abundance-model"><i class="fa fa-check"></i><b>13.3</b> Abundance models</a></li>
<li class="chapter" data-level="13.4" data-path="abundance.html"><a href="abundance.html#abundance-assess"><i class="fa fa-check"></i><b>13.4</b> Asssessment</a><ul>
<li class="chapter" data-level="13.4.1" data-path="abundance.html"><a href="abundance.html#abundance-assess-cov"><i class="fa fa-check"></i><b>13.4.1</b> Assessing covariate effects</a></li>
</ul></li>
<li class="chapter" data-level="13.5" data-path="abundance.html"><a href="abundance.html#abundance-predict"><i class="fa fa-check"></i><b>13.5</b> Prediction</a></li>
<li class="chapter" data-level="13.6" data-path="abundance.html"><a href="abundance.html#abundance-exercises"><i class="fa fa-check"></i><b>13.6</b> Exercises</a></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">eBird Best Practices Workshop</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="presabs" class="section level1">
<h1><span class="header-section-number">Lesson 6</span> Presence-absence Data</h1>
<p>Up to this point we’ve been working with presence-only data. The EBD, and eBird checklists in general, only explicitly record positive observations of species. However, if we limit ourselves to complete checklists, we can fill in the implied zero counts for any checklists on which a given species isn’t explicitly reported to generate presence-absence data. We refer to this process as <strong>zero-filling</strong> the eBird data.</p>
<p>Zero-filling relies on the Sampling Event Data, which is a tab-seperated text file containing checklist-level information. This file contains the full population of checklists in the eBird database. If we apply exactly the same set of filters to both the EBD and the Sampling Event Data we can assume that any checklist with no observations for a given species in the EBD should get a zero-count record added to the dataset. So, producing presence-absence eBird data is a two-step process:</p>
<ol style="list-style-type: decimal">
<li>Simultaneously filter the EBD and Sampling Event Data, making sure to only use complete checklists.</li>
<li>Read both files into R and zero-fill the EBD using the full population of checklists from the Sampling Event Data.</li>
</ol>
<div class="tip">
<h2>
Tip
</h2>
<p>When we say “presence-absence” what we really mean by “absence” is that the species was not detected, it’s entirely possible that the species was present, but the observer didn’t detect it.</p>
</div>
<div class="checkpoint">
<h2>
Checkpoint
</h2>
<p>Are there any conceptual questions about the process of zero-filling?</p>
</div>
<div id="presabs-filter" class="section level2">
<h2><span class="header-section-number">6.1</span> Filtering</h2>
<p>Simultaneously filtering the EBD and Sampling Event Data is done in almost the exact same way as filtering the EBD alone. The only difference is that we provide both files to <code>auk_ebd()</code> and two corresponding output files to <code>auk_filter()</code>. For example, we can extract all American Flamingo observations from January in the Mexican state of Yucatán in preparation for zero-filling.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="kw">library</span>(auk)</a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw">library</span>(tidyverse)</a>
<a class="sourceLine" id="cb29-3" data-line-number="3"></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">f_ebd &lt;-<span class="st"> &quot;data/ebd_amefla.txt&quot;</span></a>
<a class="sourceLine" id="cb29-5" data-line-number="5">f_sed &lt;-<span class="st"> &quot;data/sed_amefla.txt&quot;</span></a>
<a class="sourceLine" id="cb29-6" data-line-number="6">ebd_amefla &lt;-<span class="st"> </span><span class="kw">auk_ebd</span>(<span class="st">&quot;ebd_2014-2015_yucatan.txt&quot;</span>, </a>
<a class="sourceLine" id="cb29-7" data-line-number="7">                      <span class="dt">file_sampling =</span> <span class="st">&quot;ebd_sampling_2014-2015_yucatan.txt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-8" data-line-number="8"><span class="st">  </span><span class="kw">auk_species</span>(<span class="st">&quot;American Flamingo&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-9" data-line-number="9"><span class="st">  </span><span class="kw">auk_state</span>(<span class="st">&quot;MX-YUC&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-10" data-line-number="10"><span class="st">  </span><span class="kw">auk_date</span>(<span class="kw">c</span>(<span class="st">&quot;*-01-01&quot;</span>, <span class="st">&quot;*-01-31&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-11" data-line-number="11"><span class="st">  </span><span class="kw">auk_complete</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-12" data-line-number="12"><span class="st">  </span><span class="kw">auk_filter</span>(f_ebd, <span class="dt">file_sampling =</span> f_sed)</a></code></pre></div>
<p>We now have two output files that have been extracted using the same set of filters, apart from the species filter, which only applies to the EBD. We can read these files into R individually:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1">ebd_only &lt;-<span class="st"> </span><span class="kw">read_ebd</span>(f_ebd)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2">sed_only &lt;-<span class="st"> </span><span class="kw">read_sampling</span>(f_sed)</a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="kw">nrow</span>(ebd_only)</a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">#&gt; [1] 47</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="kw">nrow</span>(sed_only)</a>
<a class="sourceLine" id="cb30-6" data-line-number="6"><span class="co">#&gt; [1] 291</span></a></code></pre></div>
<p>So, we have 291 checklists in the Sampling Event Data and, of those, 47 have Flamingo observations on them.</p>
<div class="checkpoint">
<h2>
Checkpoint
</h2>
<p>Were you able to filter and import the EBD and Sampling Event Data? Did you get the correct number of rows in both files?</p>
</div>
<div class="exercise">
<h2>
Exercise
</h2>
<p>You’re studying Hooded Warblers wintering (November-February) in Belize. Extract eBird data in preparation for zero-filling, then read in the results and explore them. Hint: consult the Details section of the documentation for <code>auk_date()</code> to see how to filter a range of dates that wrap around the year end.</p>
<button class="solution">Solution</button>
<div class="solution-content">
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">f_ebd_hw &lt;-<span class="st"> &quot;data/ebd_hoowar.txt&quot;</span></a>
<a class="sourceLine" id="cb31-2" data-line-number="2">f_sed_hw &lt;-<span class="st"> &quot;data/sed_hoowar.txt&quot;</span></a>
<a class="sourceLine" id="cb31-3" data-line-number="3"><span class="co"># filter</span></a>
<a class="sourceLine" id="cb31-4" data-line-number="4">ebd_hoowar &lt;-<span class="st"> </span><span class="kw">auk_ebd</span>(<span class="st">&quot;ebd_2014-2015_yucatan.txt&quot;</span>, </a>
<a class="sourceLine" id="cb31-5" data-line-number="5">                      <span class="dt">file_sampling =</span> <span class="st">&quot;ebd_sampling_2014-2015_yucatan.txt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-6" data-line-number="6"><span class="st">  </span><span class="kw">auk_species</span>(<span class="st">&quot;Hooded Warbler&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-7" data-line-number="7"><span class="st">  </span><span class="kw">auk_country</span>(<span class="st">&quot;BZ&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-8" data-line-number="8"><span class="st">  </span><span class="co"># when using wildcards, dates can wrap around the year end</span></a>
<a class="sourceLine" id="cb31-9" data-line-number="9"><span class="st">  </span><span class="kw">auk_date</span>(<span class="kw">c</span>(<span class="st">&quot;*-11-01&quot;</span>, <span class="st">&quot;*-02-29&quot;</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-10" data-line-number="10"><span class="st">  </span><span class="kw">auk_complete</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb31-11" data-line-number="11"><span class="st">  </span><span class="kw">auk_filter</span>(f_ebd_hw, <span class="dt">file_sampling =</span> f_sed_hw)</a>
<a class="sourceLine" id="cb31-12" data-line-number="12"><span class="co"># import the data</span></a>
<a class="sourceLine" id="cb31-13" data-line-number="13">ebd_only_hw &lt;-<span class="st"> </span><span class="kw">read_ebd</span>(f_ebd_hw)</a>
<a class="sourceLine" id="cb31-14" data-line-number="14">sed_only_hw &lt;-<span class="st"> </span><span class="kw">read_sampling</span>(f_sed_hw)</a></code></pre></div>
</div>
</div>
</div>
<div id="presabs-zerofill" class="section level2">
<h2><span class="header-section-number">6.2</span> Zero-filling</h2>
<p>Now that we have these two datasets–containing checklist and species information, respectively–we can use the function <code>auk_zerofill()</code> to combine them to produce presence-absence data. This function also imports the data, and handles group checklists and taxonomic rollup automatically, we just have to pass it the paths to the two files. Let’s do this with the American Flamingo data.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1">ebd_zf &lt;-<span class="st"> </span><span class="kw">auk_zerofill</span>(f_ebd, <span class="dt">sampling_events =</span> f_sed)</a>
<a class="sourceLine" id="cb32-2" data-line-number="2">ebd_zf</a>
<a class="sourceLine" id="cb32-3" data-line-number="3"><span class="co">#&gt; Zero-filled EBD: 291 unique checklists, for 1 species.</span></a></code></pre></div>
<p>By default, <code>auk_zerofill()</code> returns the data as a list of two dataframes: <code>sampling_events</code> contains all the checklist and <code>observations</code> contains just the counts and presence-absence data for each species on each checklist. This compact format reduces the size of the data because checklist information isn’t replicated for every species observation.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" data-line-number="1"><span class="kw">glimpse</span>(ebd_zf<span class="op">$</span>observations)</a>
<a class="sourceLine" id="cb33-2" data-line-number="2"><span class="co">#&gt; Observations: 291</span></a>
<a class="sourceLine" id="cb33-3" data-line-number="3"><span class="co">#&gt; Variables: 4</span></a>
<a class="sourceLine" id="cb33-4" data-line-number="4"><span class="co">#&gt; $ checklist_id      &lt;chr&gt; &quot;G1089999&quot;, &quot;G1092350&quot;, &quot;G1095290&quot;, &quot;G1095467&quot;…</span></a>
<a class="sourceLine" id="cb33-5" data-line-number="5"><span class="co">#&gt; $ scientific_name   &lt;chr&gt; &quot;Phoenicopterus ruber&quot;, &quot;Phoenicopterus ruber&quot;…</span></a>
<a class="sourceLine" id="cb33-6" data-line-number="6"><span class="co">#&gt; $ observation_count &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;3&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;…</span></a>
<a class="sourceLine" id="cb33-7" data-line-number="7"><span class="co">#&gt; $ species_observed  &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, TRUE, FALSE, FALSE…</span></a>
<a class="sourceLine" id="cb33-8" data-line-number="8"><span class="kw">glimpse</span>(ebd_zf<span class="op">$</span>sampling_events)</a>
<a class="sourceLine" id="cb33-9" data-line-number="9"><span class="co">#&gt; Observations: 291</span></a>
<a class="sourceLine" id="cb33-10" data-line-number="10"><span class="co">#&gt; Variables: 31</span></a>
<a class="sourceLine" id="cb33-11" data-line-number="11"><span class="co">#&gt; $ checklist_id              &lt;chr&gt; &quot;S16201726&quot;, &quot;S21515362&quot;, &quot;S21431825&quot;,…</span></a>
<a class="sourceLine" id="cb33-12" data-line-number="12"><span class="co">#&gt; $ last_edited_date          &lt;chr&gt; &quot;2014-01-03 11:28:47&quot;, &quot;2015-01-24 11:…</span></a>
<a class="sourceLine" id="cb33-13" data-line-number="13"><span class="co">#&gt; $ country                   &lt;chr&gt; &quot;Mexico&quot;, &quot;Mexico&quot;, &quot;Mexico&quot;, &quot;Mexico&quot;…</span></a>
<a class="sourceLine" id="cb33-14" data-line-number="14"><span class="co">#&gt; $ country_code              &lt;chr&gt; &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;M…</span></a>
<a class="sourceLine" id="cb33-15" data-line-number="15"><span class="co">#&gt; $ state                     &lt;chr&gt; &quot;Yucatán&quot;, &quot;Yucatán&quot;, &quot;Yucatán&quot;, &quot;Yuca…</span></a>
<a class="sourceLine" id="cb33-16" data-line-number="16"><span class="co">#&gt; $ state_code                &lt;chr&gt; &quot;MX-YUC&quot;, &quot;MX-YUC&quot;, &quot;MX-YUC&quot;, &quot;MX-YUC&quot;…</span></a>
<a class="sourceLine" id="cb33-17" data-line-number="17"><span class="co">#&gt; $ county                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-18" data-line-number="18"><span class="co">#&gt; $ county_code               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-19" data-line-number="19"><span class="co">#&gt; $ iba_code                  &lt;chr&gt; NA, &quot;MX_183&quot;, &quot;MX_183&quot;, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-20" data-line-number="20"><span class="co">#&gt; $ bcr_code                  &lt;int&gt; 56, 55, 55, 55, 55, 55, 55, 55, 56, 56…</span></a>
<a class="sourceLine" id="cb33-21" data-line-number="21"><span class="co">#&gt; $ usfws_code                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-22" data-line-number="22"><span class="co">#&gt; $ atlas_block               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-23" data-line-number="23"><span class="co">#&gt; $ locality                  &lt;chr&gt; &quot;VALLADOLID&quot;, &quot;Celestun Casa Palmera&quot;,…</span></a>
<a class="sourceLine" id="cb33-24" data-line-number="24"><span class="co">#&gt; $ locality_id               &lt;chr&gt; &quot;L2502912&quot;, &quot;L3305787&quot;, &quot;L3305787&quot;, &quot;L…</span></a>
<a class="sourceLine" id="cb33-25" data-line-number="25"><span class="co">#&gt; $ locality_type             &lt;chr&gt; &quot;P&quot;, &quot;P&quot;, &quot;P&quot;, &quot;H&quot;, &quot;H&quot;, &quot;H&quot;, &quot;P&quot;, &quot;P&quot;…</span></a>
<a class="sourceLine" id="cb33-26" data-line-number="26"><span class="co">#&gt; $ latitude                  &lt;dbl&gt; 20.7, 20.9, 20.9, 21.0, 20.7, 21.0, 21…</span></a>
<a class="sourceLine" id="cb33-27" data-line-number="27"><span class="co">#&gt; $ longitude                 &lt;dbl&gt; -88.2, -90.4, -90.4, -89.6, -89.7, -89…</span></a>
<a class="sourceLine" id="cb33-28" data-line-number="28"><span class="co">#&gt; $ observation_date          &lt;date&gt; 2014-01-01, 2015-01-24, 2015-01-20, 2…</span></a>
<a class="sourceLine" id="cb33-29" data-line-number="29"><span class="co">#&gt; $ time_observations_started &lt;chr&gt; &quot;10:15:00&quot;, &quot;09:00:00&quot;, &quot;06:45:00&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb33-30" data-line-number="30"><span class="co">#&gt; $ observer_id               &lt;chr&gt; &quot;obs439605&quot;, &quot;obs170749&quot;, &quot;obs170749&quot;,…</span></a>
<a class="sourceLine" id="cb33-31" data-line-number="31"><span class="co">#&gt; $ sampling_event_identifier &lt;chr&gt; &quot;S16201726&quot;, &quot;S21515362&quot;, &quot;S21431825&quot;,…</span></a>
<a class="sourceLine" id="cb33-32" data-line-number="32"><span class="co">#&gt; $ protocol_type             &lt;chr&gt; &quot;Traveling&quot;, &quot;Stationary&quot;, &quot;Traveling&quot;…</span></a>
<a class="sourceLine" id="cb33-33" data-line-number="33"><span class="co">#&gt; $ protocol_code             &lt;chr&gt; &quot;P22&quot;, &quot;P21&quot;, &quot;P22&quot;, &quot;P22&quot;, &quot;P21&quot;, &quot;P2…</span></a>
<a class="sourceLine" id="cb33-34" data-line-number="34"><span class="co">#&gt; $ project_code              &lt;chr&gt; &quot;EBIRD_MEX&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;…</span></a>
<a class="sourceLine" id="cb33-35" data-line-number="35"><span class="co">#&gt; $ duration_minutes          &lt;int&gt; 90, 150, 120, 45, 30, 120, 5, 450, 105…</span></a>
<a class="sourceLine" id="cb33-36" data-line-number="36"><span class="co">#&gt; $ effort_distance_km        &lt;dbl&gt; 1.609, NA, 0.322, 0.322, NA, 2.000, NA…</span></a>
<a class="sourceLine" id="cb33-37" data-line-number="37"><span class="co">#&gt; $ effort_area_ha            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-38" data-line-number="38"><span class="co">#&gt; $ number_observers          &lt;int&gt; 4, 1, 1, 2, 2, 1, 1, 3, 13, 1, 1, 5, 5…</span></a>
<a class="sourceLine" id="cb33-39" data-line-number="39"><span class="co">#&gt; $ all_species_reported      &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TR…</span></a>
<a class="sourceLine" id="cb33-40" data-line-number="40"><span class="co">#&gt; $ group_identifier          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb33-41" data-line-number="41"><span class="co">#&gt; $ trip_comments             &lt;chr&gt; &quot;RECORRIDO POR UNA HACIENDA.&quot;, &quot;from p…</span></a></code></pre></div>
<p>However, in this case object size isn’t an issue, and it’s easier to work with a single dataframe, so we can collapse the data with <code>collapse_zerofill()</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" data-line-number="1">ebd_zf_df &lt;-<span class="st"> </span><span class="kw">collapse_zerofill</span>(ebd_zf)</a>
<a class="sourceLine" id="cb34-2" data-line-number="2"><span class="kw">glimpse</span>(ebd_zf_df)</a>
<a class="sourceLine" id="cb34-3" data-line-number="3"><span class="co">#&gt; Observations: 291</span></a>
<a class="sourceLine" id="cb34-4" data-line-number="4"><span class="co">#&gt; Variables: 34</span></a>
<a class="sourceLine" id="cb34-5" data-line-number="5"><span class="co">#&gt; $ checklist_id              &lt;chr&gt; &quot;S16201726&quot;, &quot;S21515362&quot;, &quot;S21431825&quot;,…</span></a>
<a class="sourceLine" id="cb34-6" data-line-number="6"><span class="co">#&gt; $ last_edited_date          &lt;chr&gt; &quot;2014-01-03 11:28:47&quot;, &quot;2015-01-24 11:…</span></a>
<a class="sourceLine" id="cb34-7" data-line-number="7"><span class="co">#&gt; $ country                   &lt;chr&gt; &quot;Mexico&quot;, &quot;Mexico&quot;, &quot;Mexico&quot;, &quot;Mexico&quot;…</span></a>
<a class="sourceLine" id="cb34-8" data-line-number="8"><span class="co">#&gt; $ country_code              &lt;chr&gt; &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;MX&quot;, &quot;M…</span></a>
<a class="sourceLine" id="cb34-9" data-line-number="9"><span class="co">#&gt; $ state                     &lt;chr&gt; &quot;Yucatán&quot;, &quot;Yucatán&quot;, &quot;Yucatán&quot;, &quot;Yuca…</span></a>
<a class="sourceLine" id="cb34-10" data-line-number="10"><span class="co">#&gt; $ state_code                &lt;chr&gt; &quot;MX-YUC&quot;, &quot;MX-YUC&quot;, &quot;MX-YUC&quot;, &quot;MX-YUC&quot;…</span></a>
<a class="sourceLine" id="cb34-11" data-line-number="11"><span class="co">#&gt; $ county                    &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-12" data-line-number="12"><span class="co">#&gt; $ county_code               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-13" data-line-number="13"><span class="co">#&gt; $ iba_code                  &lt;chr&gt; NA, &quot;MX_183&quot;, &quot;MX_183&quot;, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-14" data-line-number="14"><span class="co">#&gt; $ bcr_code                  &lt;int&gt; 56, 55, 55, 55, 55, 55, 55, 55, 56, 56…</span></a>
<a class="sourceLine" id="cb34-15" data-line-number="15"><span class="co">#&gt; $ usfws_code                &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-16" data-line-number="16"><span class="co">#&gt; $ atlas_block               &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-17" data-line-number="17"><span class="co">#&gt; $ locality                  &lt;chr&gt; &quot;VALLADOLID&quot;, &quot;Celestun Casa Palmera&quot;,…</span></a>
<a class="sourceLine" id="cb34-18" data-line-number="18"><span class="co">#&gt; $ locality_id               &lt;chr&gt; &quot;L2502912&quot;, &quot;L3305787&quot;, &quot;L3305787&quot;, &quot;L…</span></a>
<a class="sourceLine" id="cb34-19" data-line-number="19"><span class="co">#&gt; $ locality_type             &lt;chr&gt; &quot;P&quot;, &quot;P&quot;, &quot;P&quot;, &quot;H&quot;, &quot;H&quot;, &quot;H&quot;, &quot;P&quot;, &quot;P&quot;…</span></a>
<a class="sourceLine" id="cb34-20" data-line-number="20"><span class="co">#&gt; $ latitude                  &lt;dbl&gt; 20.7, 20.9, 20.9, 21.0, 20.7, 21.0, 21…</span></a>
<a class="sourceLine" id="cb34-21" data-line-number="21"><span class="co">#&gt; $ longitude                 &lt;dbl&gt; -88.2, -90.4, -90.4, -89.6, -89.7, -89…</span></a>
<a class="sourceLine" id="cb34-22" data-line-number="22"><span class="co">#&gt; $ observation_date          &lt;date&gt; 2014-01-01, 2015-01-24, 2015-01-20, 2…</span></a>
<a class="sourceLine" id="cb34-23" data-line-number="23"><span class="co">#&gt; $ time_observations_started &lt;chr&gt; &quot;10:15:00&quot;, &quot;09:00:00&quot;, &quot;06:45:00&quot;, &quot;0…</span></a>
<a class="sourceLine" id="cb34-24" data-line-number="24"><span class="co">#&gt; $ observer_id               &lt;chr&gt; &quot;obs439605&quot;, &quot;obs170749&quot;, &quot;obs170749&quot;,…</span></a>
<a class="sourceLine" id="cb34-25" data-line-number="25"><span class="co">#&gt; $ sampling_event_identifier &lt;chr&gt; &quot;S16201726&quot;, &quot;S21515362&quot;, &quot;S21431825&quot;,…</span></a>
<a class="sourceLine" id="cb34-26" data-line-number="26"><span class="co">#&gt; $ protocol_type             &lt;chr&gt; &quot;Traveling&quot;, &quot;Stationary&quot;, &quot;Traveling&quot;…</span></a>
<a class="sourceLine" id="cb34-27" data-line-number="27"><span class="co">#&gt; $ protocol_code             &lt;chr&gt; &quot;P22&quot;, &quot;P21&quot;, &quot;P22&quot;, &quot;P22&quot;, &quot;P21&quot;, &quot;P2…</span></a>
<a class="sourceLine" id="cb34-28" data-line-number="28"><span class="co">#&gt; $ project_code              &lt;chr&gt; &quot;EBIRD_MEX&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;, &quot;EBIRD&quot;…</span></a>
<a class="sourceLine" id="cb34-29" data-line-number="29"><span class="co">#&gt; $ duration_minutes          &lt;int&gt; 90, 150, 120, 45, 30, 120, 5, 450, 105…</span></a>
<a class="sourceLine" id="cb34-30" data-line-number="30"><span class="co">#&gt; $ effort_distance_km        &lt;dbl&gt; 1.609, NA, 0.322, 0.322, NA, 2.000, NA…</span></a>
<a class="sourceLine" id="cb34-31" data-line-number="31"><span class="co">#&gt; $ effort_area_ha            &lt;dbl&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-32" data-line-number="32"><span class="co">#&gt; $ number_observers          &lt;int&gt; 4, 1, 1, 2, 2, 1, 1, 3, 13, 1, 1, 5, 5…</span></a>
<a class="sourceLine" id="cb34-33" data-line-number="33"><span class="co">#&gt; $ all_species_reported      &lt;lgl&gt; TRUE, TRUE, TRUE, TRUE, TRUE, TRUE, TR…</span></a>
<a class="sourceLine" id="cb34-34" data-line-number="34"><span class="co">#&gt; $ group_identifier          &lt;chr&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…</span></a>
<a class="sourceLine" id="cb34-35" data-line-number="35"><span class="co">#&gt; $ trip_comments             &lt;chr&gt; &quot;RECORRIDO POR UNA HACIENDA.&quot;, &quot;from p…</span></a>
<a class="sourceLine" id="cb34-36" data-line-number="36"><span class="co">#&gt; $ scientific_name           &lt;chr&gt; &quot;Phoenicopterus ruber&quot;, &quot;Phoenicopteru…</span></a>
<a class="sourceLine" id="cb34-37" data-line-number="37"><span class="co">#&gt; $ observation_count         &lt;chr&gt; &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;0&quot;, &quot;15…</span></a>
<a class="sourceLine" id="cb34-38" data-line-number="38"><span class="co">#&gt; $ species_observed          &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FAL…</span></a></code></pre></div>
<p>Notice that in addition to the <code>observation_count</code> column, we now have a binary <code>species_observered</code> column specifying whether or not the species was observered on this checklist. You can also automatically collapse the data by using the <code>collapse = TRUE</code> argument to <code>auk_zerofill()</code>.</p>
<div class="exercise">
<h2>
Exercise
</h2>
<p>Zero-fill and collapse the Hooded Warbler data you extracted in the previous exercise. What proportion of checklists detected this species?</p>
<button class="solution">Solution</button>
<div class="solution-content">
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1">ebd_zf_hw &lt;-<span class="st"> </span><span class="kw">auk_zerofill</span>(f_ebd_hw, f_sed_hw, <span class="dt">collapse =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb35-2" data-line-number="2"><span class="co"># proportion of checklists</span></a>
<a class="sourceLine" id="cb35-3" data-line-number="3"><span class="kw">mean</span>(ebd_zf_hw<span class="op">$</span>species_observed)</a>
<a class="sourceLine" id="cb35-4" data-line-number="4"><span class="co">#&gt; [1] 0.268</span></a></code></pre></div>
</div>
</div>
<div class="tip">
<h2>
Tip
</h2>
<p>Whenever you’re zero-filling data it’s critical that you think about region and season (i.e. where and when) in addition to just the species. If you don’t do that, you’ll zero-fill the entire global EBD and your computer will explode! For example, consider a highly localized species like the <a href="https://ebird.org/species/cozvir1">Cozumel Vireo</a>, endemic to the small island of Cozumel off the coast of Mexico. Let’s try just filtering on species.</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" data-line-number="1">ebd_cozvir &lt;-<span class="st"> </span><span class="kw">auk_ebd</span>(<span class="st">&quot;ebd_2014-2015_yucatan.txt&quot;</span>, </a>
<a class="sourceLine" id="cb36-2" data-line-number="2">                    <span class="dt">file_sampling =</span> <span class="st">&quot;ebd_sampling_2014-2015_yucatan.txt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-3" data-line-number="3"><span class="st">  </span><span class="kw">auk_species</span>(<span class="st">&quot;Cozumel Vireo&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-4" data-line-number="4"><span class="st">  </span><span class="kw">auk_complete</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-5" data-line-number="5"><span class="st">  </span><span class="kw">auk_filter</span>(<span class="st">&quot;data/ebd_cozvir.txt&quot;</span>, <span class="st">&quot;data/sed_cozvir.txt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb36-6" data-line-number="6"><span class="st">  </span><span class="kw">auk_zerofill</span>(<span class="dt">collapse =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb36-7" data-line-number="7"><span class="kw">table</span>(ebd_cozvir<span class="op">$</span>species_observed)</a>
<a class="sourceLine" id="cb36-8" data-line-number="8"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb36-9" data-line-number="9"><span class="co">#&gt; FALSE  TRUE </span></a>
<a class="sourceLine" id="cb36-10" data-line-number="10"><span class="co">#&gt; 22250   107</span></a></code></pre></div>
<p>What we have here is the entire EBD (22 thousand checklists in the example dataset, and 40 million in the full EBD!) for a species that only occurs on one small island. Do we really care that a checklist in Anchorage, Alaska doesn’t have Cozumel Vireo? In this situation, you would be better to identify the boundaries of the island and use <code>auk_bbox()</code> to spatially subset the data.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1">ebd_cozvir &lt;-<span class="st"> </span><span class="kw">auk_ebd</span>(<span class="st">&quot;ebd_2014-2015_yucatan.txt&quot;</span>, </a>
<a class="sourceLine" id="cb37-2" data-line-number="2">                      <span class="dt">file_sampling =</span> <span class="st">&quot;ebd_sampling_2014-2015_yucatan.txt&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-3" data-line-number="3"><span class="st">  </span><span class="kw">auk_species</span>(<span class="st">&quot;Cozumel Vireo&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-4" data-line-number="4"><span class="st">  </span><span class="co"># lng_min, lat_min, lng_max, lat_max</span></a>
<a class="sourceLine" id="cb37-5" data-line-number="5"><span class="st">  </span><span class="kw">auk_bbox</span>(<span class="kw">c</span>(<span class="op">-</span><span class="fl">87.1</span>, <span class="fl">20.2</span>, <span class="fl">-86.7</span>, <span class="fl">20.6</span>)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-6" data-line-number="6"><span class="st">  </span><span class="kw">auk_complete</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-7" data-line-number="7"><span class="st">  </span><span class="kw">auk_filter</span>(<span class="st">&quot;data/ebd_cozvir.txt&quot;</span>, <span class="st">&quot;data/sed_cozvir.txt&quot;</span>, <span class="dt">overwrite =</span> <span class="ot">TRUE</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-8" data-line-number="8"><span class="st">  </span><span class="kw">auk_zerofill</span>(<span class="dt">collapse =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb37-9" data-line-number="9"><span class="kw">table</span>(ebd_cozvir<span class="op">$</span>species_observed)</a>
<a class="sourceLine" id="cb37-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb37-11" data-line-number="11"><span class="co">#&gt; FALSE  TRUE </span></a>
<a class="sourceLine" id="cb37-12" data-line-number="12"><span class="co">#&gt;   433   107</span></a></code></pre></div>
<p>We have the same number of positive observations, but have now drastically reduced the number of checklists that didn’t detect Cozumel Vireo observations.</p>
</div>
</div>
<div id="presabs-tidy" class="section level2">
<h2><span class="header-section-number">6.3</span> Tidying up</h2>
<p>We now have a zero-filled presence-absence dataset with duplicate group checklists removed and all observations at the species level. There are couple remaining steps that we typically run to clean up the data. First, you may have noticed some cases where <code>observation_count</code> is <code>&quot;X&quot;</code> in the data. This is what eBirders enter for the count to indicate that they didn’t count the number of individuals for a given species.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb38-1" data-line-number="1"><span class="kw">arrange</span>(ebd_zf_df, <span class="kw">desc</span>(observation_count)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-2" data-line-number="2"><span class="st">  </span><span class="kw">select</span>(checklist_id, observation_count) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb38-3" data-line-number="3"><span class="st">  </span><span class="kw">head</span>(<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb38-4" data-line-number="4"><span class="co">#&gt; # A tibble: 10 x 2</span></a>
<a class="sourceLine" id="cb38-5" data-line-number="5"><span class="co">#&gt;   checklist_id observation_count</span></a>
<a class="sourceLine" id="cb38-6" data-line-number="6"><span class="co">#&gt;   &lt;chr&gt;        &lt;chr&gt;            </span></a>
<a class="sourceLine" id="cb38-7" data-line-number="7"><span class="co">#&gt; 1 S26749776    X                </span></a>
<a class="sourceLine" id="cb38-8" data-line-number="8"><span class="co">#&gt; 2 S16248765    X                </span></a>
<a class="sourceLine" id="cb38-9" data-line-number="9"><span class="co">#&gt; 3 S16540721    X                </span></a>
<a class="sourceLine" id="cb38-10" data-line-number="10"><span class="co">#&gt; 4 S16490447    X                </span></a>
<a class="sourceLine" id="cb38-11" data-line-number="11"><span class="co">#&gt; 5 S16520714    X                </span></a>
<a class="sourceLine" id="cb38-12" data-line-number="12"><span class="co">#&gt; 6 S16382176    X                </span></a>
<a class="sourceLine" id="cb38-13" data-line-number="13"><span class="co">#&gt; # … with 4 more rows</span></a></code></pre></div>
<p>It’s more appropriate to have the count as <code>NA</code> rather than <code>&quot;X&quot;</code> in this scenario. This will also allow us to convert the count column to integer rather than character. At this point, we’ll also assign an explicit distance of 0 to stationary checklists.</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1">zf_count &lt;-<span class="st"> </span>ebd_zf_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">observation_count =</span> <span class="kw">if_else</span>(observation_count <span class="op">==</span><span class="st"> &quot;X&quot;</span>, </a>
<a class="sourceLine" id="cb39-3" data-line-number="3">                                     <span class="ot">NA_character_</span>, observation_count),</a>
<a class="sourceLine" id="cb39-4" data-line-number="4">         <span class="dt">observation_count =</span> <span class="kw">as.integer</span>(observation_count),</a>
<a class="sourceLine" id="cb39-5" data-line-number="5">         <span class="dt">effort_distance_km =</span> <span class="kw">if_else</span>(protocol_type <span class="op">==</span><span class="st"> &quot;Stationary&quot;</span>, </a>
<a class="sourceLine" id="cb39-6" data-line-number="6">                                      <span class="dv">0</span>, effort_distance_km))</a></code></pre></div>
<p>Finally, depending on your application, you’ll likely want to do some further filtering of the data. For many uses, it’s a good idea to reduce the variation in detectability between checklists by imposing some constraints on the effort variables. You can think of this as partially standardizing the observation process in a <em>post hoc</em> fashion. For example, in part II of this workshop, we’ll restrict observations to those from checklists less than 5 hours long and 5 km in length, and with 10 or fewer observers.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1">zf_effort &lt;-<span class="st"> </span>zf_count <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" data-line-number="2"><span class="st">  </span><span class="kw">filter</span>(duration_minutes <span class="op">&lt;=</span><span class="st"> </span><span class="dv">60</span> <span class="op">*</span><span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb40-3" data-line-number="3">         effort_distance_km <span class="op">&lt;=</span><span class="st"> </span><span class="dv">5</span>,</a>
<a class="sourceLine" id="cb40-4" data-line-number="4">         number_observers <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>)</a>
<a class="sourceLine" id="cb40-5" data-line-number="5"><span class="kw">table</span>(zf_count<span class="op">$</span>species_observed)</a>
<a class="sourceLine" id="cb40-6" data-line-number="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb40-7" data-line-number="7"><span class="co">#&gt; FALSE  TRUE </span></a>
<a class="sourceLine" id="cb40-8" data-line-number="8"><span class="co">#&gt;   244    47</span></a>
<a class="sourceLine" id="cb40-9" data-line-number="9"><span class="kw">table</span>(zf_effort<span class="op">$</span>species_observed)</a>
<a class="sourceLine" id="cb40-10" data-line-number="10"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb40-11" data-line-number="11"><span class="co">#&gt; FALSE  TRUE </span></a>
<a class="sourceLine" id="cb40-12" data-line-number="12"><span class="co">#&gt;   217    25</span></a></code></pre></div>
<p>We’ve reduced the amount of data, but also decreased the variability in effort, which will lead to better model performance if we use these data to model species distributions. At this point, we can save the resulting processed eBird data, so that we can use it later in our analysis workflow.</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1"><span class="kw">write_csv</span>(zf_effort, <span class="st">&quot;data/ebird_amefla_zf.csv&quot;</span>)</a></code></pre></div>

</div>
</div>
<script>
var coll = document.getElementsByClassName("solution");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
  });
}
</script>
            </section>

          </div>
        </div>
      </div>
<a href="import.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="subsampling.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/mstrimas/ebp-workshop/edit/master/06_presabs.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
